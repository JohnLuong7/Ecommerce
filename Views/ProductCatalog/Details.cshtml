@model Ecommerce.Models.Product

<div class="container my-4">
    <div class="row">
        <!-- Cột ảnh sản phẩm -->
        <div class="col-md-6">
            <img id="mainImage"
                 src="~/images/@Model.ProductImages.FirstOrDefault(pi => pi.IsMain)?.FileName"
                 alt="@Model.Name"
                 class="img-fluid border rounded mb-3"
                 style="max-height: 450px; object-fit: contain;" />

            @if (Model.ProductImages.Count > 1)
            {
                <div class="d-flex flex-row flex-nowrap overflow-auto" style="gap: 8px;">
                    @foreach (var img in Model.ProductImages)
                    {
                        <img src="~/images/@img.FileName"
                             alt="Ảnh phụ"
                             class="border rounded"
                             style="width: 90px; height: 90px; object-fit: contain; cursor: pointer; transition: 0.2s;"
                             onmouseover="document.querySelector('#mainImage').src=this.src" />
                    }
                </div>
            }
        </div>

        <!-- Cột thông tin sản phẩm -->
        <div class="col-md-6">
            <h2>@Model.Name</h2>
            <h3 class="text-success">@Model.Price.ToString("C")</h3>

            <p><strong>Danh mục:</strong> @Model.Category?.Name</p>
            <p>
                <strong>Số lượng tồn kho:</strong>
                @(Model.Inventory?.Quantity > 0 ? Model.Inventory.Quantity.ToString() : "Hết hàng")
            </p>
            <p>@Model.Description</p>
            <p><strong>Trạng thái:</strong> @(Model.IsPublished ? "Đã đăng bán" : "Chưa đăng bán")</p>

            <form asp-controller="Cart" asp-action="Add" method="post" class="d-flex align-items-center mt-3">
                <input type="hidden" name="productId" value="@Model.ProductId" />
                <input type="number"
                       name="quantity"
                       value="1"
                       min="1"
                       class="form-control me-2"
                       style="max-width: 80px;"
                       @(Model.IsPublished && Model.Inventory?.Quantity > 0 ? "" : "disabled") />
                <button type="submit"
                        class="btn btn-success"
                        @(Model.IsPublished && Model.Inventory?.Quantity > 0 ? "" : "disabled")>
                    🛒 Thêm vào giỏ
                </button>
            </form>

            @if (!Model.IsPublished)
            {
                <div class="text-danger mt-2">Sản phẩm này chưa được đăng bán.</div>
            }
            else if (Model.Inventory?.Quantity == 0)
            {
                <div class="text-danger mt-2">Sản phẩm đã hết hàng.</div>
            }
        </div>
    </div>
</div>
